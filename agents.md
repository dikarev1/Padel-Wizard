# agents.md

## **О проекте**

Padel Wizard — Telegram-бот, который помогает игрокам паделя определить свой реальный уровень игры и получить рекомендации по улучшению.

Бот опирается на строгую таблицу уровней (см. `documentation/padel_levels_draft.csv`) и Манифест (`documentation/manifesto.md`).

Вся логика оценки навыков, вопросов и переходов внутри опросника должна соответствовать этим документам.

---

## **Главные правила для любого агента**

### **1. Документация — источник правды №1**

Всегда следуй содержимому:

- `documentation/manifesto.md`
- `documentation/padel_levels_draft.csv`
- `documentation/aiogram_basic_info.md`
- `documentation/aiogram_methods_and_features_structure.md`
- `documentation/telegram_api_doc.md`
- `documentation/telegram_bot_features.md`
- `documentation/telegram_quick_start.md`

Если возникают конфликты между предположениями агента и документацией —

**побеждает документация**.

---

### **2. Таблица уровней — источник правды №2**

`documentation/padel_levels_draft.csv` определяет:

- названия уровней
- границы между уровнями
- опыт (hours)
- навыки (arsenal)
- тактику
- стабильность
- сложность мячей
- арсенал

Любая генерация логики, вопросов, scoring-алгоритмов или рекомендаций должна **строго соответствовать** логики таблицы.

Нельзя придумывать новые уровни без её обновления.

---

### **3. Манифест определяет структуру бота**

`documentation/manifesto.md` описывает:

1. Приветствие, цель, ограничения
2. Динамический опросник, который зависит от ответов (может быть больше или меньше вопросов)
3. Финальный экран, финальный рейтинг + фидбек и опциональные советы

Бот **должен соответствовать этой структуре**.

---

## **Структура репозитория (основная, примерная)**

```
Padel-Wizard
│
├── agents.md                 ← этот файл
├── README.md                 ← общее описание проекта
├── requirements.txt
├── logs/                     ← логи бота
│
├── documentation/            ← ВСЯ документация, обязательная для агента
│   ├── manifesto.md
│   ├── padel_levels_draft.csv
│   ├── aiogram_basic_info.md
│   ├── aiogram_methods_and_features_structure.md
│   ├── telegram_api_doc.md
│   ├── telegram_bot_features.md
│   └── telegram_quick_start.md
│
├── padel_wizard_bot/
│   ├── bot.py                ← точка входа / запуск бота
│   ├── logging_config.py
│   └── ...                   ← вспомогательные модули
│
├── handlers/                 ← Telegram хендлеры
├── keyboards/                ← инлайн/реплай клавиатуры
├── services/                 ← бизнес-логика (опросник, scoring, рекомендации)
├── storage/                  ← работа с БД, модели и репозитории
├── data/                     ← статические данные и кэш
└── tests/                    ← тесты

```

---

## **Как агенту работать с проектом**

### **1. Понимание контекста**

Перед изменениями агент обязан:

- прочитать `manifesto.md`
- изучить `padel_levels_draft.csv`
- учитывать всё из `documentation/*`
- понимать структуру кода по папкам

### **2. Приоритет логики**

При разработке логики:

1. CSV с уровнями
2. Манифест
3. Текущие модули `services/`
4. Структура хендлеров в `handlers/`
5. Описание Telegram API (в документации)

### **3. Код-стиль и архитектура**

Агент должен поддерживать такую архитектуру:

- **handlers/** реагируют на события Telegram
- **services/** содержат чистую бизнес-логику
- **storage/** сохраняет и читает данные
- **keyboards/** только кнопки
- **bot.py** только запуск, регистрация хендлеров и логирование

Логика паделя должна быть изолирована внутри `services/`.

---

## **Требования к функциональности бота**

### **1. Приветствие**

Должно:

- объяснять цель
- показывать этапы
- сообщать ограничения
- начинать диалог простой кнопкой

### **2. Опросник**

Должен быть:

- адаптивным
- опирающимся на предыдущие ответы
- валидируемым
- связанным с таблицей уровней

### **3. Финальный экран**

Должен:

- выводить уровень
- показывать пояснение
- предлагать фидбек
- давать кнопку «получить советы»

### **4. Хранение данных**

Агент должен держать в уме структуру хранения:

- user
- session
- answers
- results
- feedback

Если структура БД меняется — агент обязан сохранить обратную совместимость.

---

## **Ограничения, обязательные для агента**

1. **Не добавлять уровни, не описанные в `padel_levels_draft.csv`.**
2. **Не менять значения опыта, навыков и критериев без обновления таблицы.**
3. **Не нарушать структуру, описанную в манифесте.**
4. **Не создавать хаотичные хендлеры — всё должно быть структурировано.**
5. **Не дублировать логику в разных модулях — единый источник правды.**

---

## **Как тестировать**

Агент обязан соблюдать:

- успешный запуск бота
- стабильную обработку `/start`
- корректный переход к опроснику
- вывод финального уровня без ошибок
- корректное логирование. Включая: каждое действие пользователя (клик по кнопке) должно логгироваться вида "пользователь *name/inknown* нажал на кнопку *название кнопки"* . Каждое отображение экрана без кнопок тоже должно логгироваться (стартовый и финальный экраны вида "пользователь *name/onknown* увидел первый экран, пользователь *name/unknown* завершил опросник и получил результат)
- не используй slots (мое окружение не умеет их поддерживать)

---

## **Цель AGENTS.md**

Обеспечить единое, неизменное понимание:

- как устроен проект
- где находится документация
- что является истиной
- как агенту действовать, чтобы не сломать систему.